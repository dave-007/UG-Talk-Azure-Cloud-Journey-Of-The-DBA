(window.webpackJsonp=window.webpackJsonp||[]).push([["telemetry"],{C4R5:function(t,e,o){"use strict";o.d(e,"c",(function(){return y})),o.d(e,"e",(function(){return g})),o.d(e,"b",(function(){return u})),o.d(e,"a",(function(){return f})),o.d(e,"d",(function(){return P}));var i,a=o("D57K"),n=o("9J8d"),s=o("FaCY"),c=o("s9+9"),r=o("rvYQ"),d=o("Z3LZ");class l{constructor(t,e){this.onUpdateFollowedTopics=()=>{if(!this.connector)return this.onRouteUpdateCallback([]);const t=this.connector.getCurrentState(),e=t.followedTopicIds,o=t.topicMap,a=[];e&&o&&e.forEach(t=>{const e=o[t],n={path:y(e.canonicalName||e.name,t),display:e.name,experienceInfo:this.dynamicRouteExperienceInfo,context:{feedId:t},pivotId:t,dynamicPivotSource:i.TopicsData};a.push(n)}),this.onRouteUpdateCallback(a)},this.onRouteUpdateCallback=t,this.dynamicRouteExperienceInfo=e}getDynamicPivotsFromDataConnector(t){return Object(a.b)(this,void 0,void 0,(function*(){switch(t){case c.a.TopicData:yield this.getPivotsFromTopicData();break;case c.a.NavigationData:yield this.getPivotsFromNavigationData();break;default:return}}))}getPivotsFromTopicData(){return Object(a.b)(this,void 0,void 0,(function*(){yield Object(d.l)(),n.a.getInstance().rootReducer.getDataConnector(c.a.TopicData).then(t=>{this.connector=t,this.connector.getFollowedTopics(!1).then(()=>{this.onUpdateFollowedTopics()})}),s.a.followedTopics.registerObserver(this.onUpdateFollowedTopics),s.a.updateTopicFollowedState.registerObserver(this.onUpdateFollowedTopics)}))}getPivotsFromNavigationData(){return Object(a.b)(this,void 0,void 0,(function*(){if(this.connector=yield n.a.getInstance().rootReducer.getDataConnector(c.a.NavigationData),this.connector){const t=yield this.connector.getNavigationItems(r.a.HostPage.verticalKey,r.a.HostPage.categoryKey);this.onRouteUpdateCallback(this.mapNavigationItemsToDynamicRoutes(t))}else this.onRouteUpdateCallback([])}))}mapNavigationItemsToDynamicRoutes(t){return t.map(t=>({path:t.targetUrl,externalUrl:t.targetUrl,display:t.displayText,pivotId:t.categoryKey,dynamicPivotSource:i.NavigationData}))}}!function(t){t.NavigationData="NavigationDataAdapter",t.TopicsData="TopicsDataAdapter"}(i||(i={}));var u,p=o("b2pY"),h=o("dTwT");class m{constructor(t){this.staticRoutes=[],this.dynamicRoutes=[],this.onUpdateRoutesCallbacks=[],this.switchListeners=[],this.callSwitchListeners=t=>{if(!this.switchListeners.length)return;const e=this.getPivotSelectionInfoFromPath(t.state&&t.state.previousPath),o=this.getPivotSelectionInfoFromPath(t.pathname),i={newSelection:o,oldSelection:e};this.config.enableRememberedPivots&&h.a.setItem(w,o&&o.pivotId),this.switchListeners.sort((t,e)=>t.order-e.order);for(const t of this.switchListeners)t.callback(i)},t&&this.setRoutes(t),p.a.listen(this.callSwitchListeners)}setRoutes(t){this.config=t,this.setStaticRoutes(),this.config.disableLoadingDynamicRoutes||this.setDynamicRoutes()}pushHistory(t,e,o,i){const a=p.a.location.pathname;p.a.push(y(t,e),{previousPath:a,context:o},i)}getStaticRoutes(){return this.staticRoutes}getDynamicRoutes(){return this.dynamicRoutes}getDynamicRoute(){return{path:f.interest,experienceInfo:this.config.dynamicRouteExperienceInfo,pivotId:"oneriver.xfeed"}}getRouteByPrimePathOrVerticalKey(t,e){if(!e&&!t)return;let o=void 0;for(let i=0;i<this.staticRoutes.length;i++){if(this.staticRoutes[i].primePath===t)return this.staticRoutes[i];this.staticRoutes[i].verticalKeys&&this.staticRoutes[i].verticalKeys.indexOf(e)>=0&&(o=this.staticRoutes[i])}return o}getCurrentRoute(){const t=p.a.location.pathname,e=this.staticRoutes.find(e=>e.path===t);return e||(t.includes("/interest")?this.getDynamicRoute():null)}addDynamicRouteListener(t){this.onUpdateRoutesCallbacks.push(t)}addSwitchListener(t,e=v.AfterLoadContent){this.switchListeners.push({callback:t,order:e})}getRememberedPivot(){if(!this.config.enableRememberedPivots)return;const t=h.a.getItem(w);t&&this.config.staticRoutes.forEach(e=>{e.pivotId===t&&this.pushHistory(e.canonicalName)})}getPivotSelectionInfoFromPath(t){if(!t)return null;const e=this.config.staticRoutes.find(e=>y(e.canonicalName)===t);if(e)return{pivotId:e.pivotId,telemetryPageName:e.telemetryPageName,telemetryPivotCategory:e.telemetryPivotCategory,display:e.canonicalName};if(0===t.indexOf("/interest")){const e=t.split("/");let o=void 0;return e.length>=4&&(o="null"===e[3]?e[2]:e[3]),{pivotId:o,telemetryPageName:"xfeed",telemetryPivotCategory:"news",display:e.length>=3&&e[2]}}return null}setStaticRoutes(){const{staticRoutes:t}=this.config;t.forEach(t=>{const e={path:y(t.canonicalName)||t.externalUrl,externalUrl:t.externalUrl,experienceInfo:t.experienceInfo,queryParamOverrides:t.queryParamOverrides,display:t.canonicalName,pivotId:t.pivotId,verticalKeys:t.verticalKeys,primePath:t.primePath};this.staticRoutes.push(e)})}setDynamicRoutes(){return Object(a.b)(this,void 0,void 0,(function*(){const t=new l(this.onUpdateDynamicRoute.bind(this),this.config.dynamicRouteExperienceInfo);yield t.getDynamicPivotsFromDataConnector(this.config.dynamicRouteDataConnector)}))}onUpdateDynamicRoute(t){this.dynamicRoutes=t;for(const t of this.onUpdateRoutesCallbacks)t(this.dynamicRoutes)}}function y(t,e){if(!t)return"";if(e){return`/interest/${t.toLowerCase().replace(/\s/g,"").replace(/\//g,"-")}/${e}`}return f[t]||"/"+t}function g(t){return!!(t&&t.oldSelection&&t.newSelection)&&(!(!t.oldSelection||!t.oldSelection.pivotId)&&!(!t.newSelection||!t.newSelection.pivotId))}!function(t){t.MyFeed="myFeed",t.Personalize="personalize"}(u||(u={}));const f={myFeed:"/",personalize:"/personalize",interest:"/interest/*/:id"};var v;!function(t){t[t.Telemetry=0]="Telemetry",t[t.Monetization=1]="Monetization",t[t.LoadContent=2]="LoadContent",t[t.AfterLoadContent=3]="AfterLoadContent"}(v||(v={}));const w="selectedPivot";let R;const P=t=>R?(t&&R.setRoutes(t),R):(R=new m(t),R)},FaCY:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var i=o("G82u");class a{}a.followedTopics=new i.a("FollowedTopics"),a.followedTopicsFailed=new i.a("FollowedTopicsFailedSignature"),a.recommendedTopics=new i.a("RecommendedTopics"),a.recommendedTopicsFailed=new i.a("RecommendedTopicsFailed"),a.topic=new i.a("Topic"),a.topicFailed=new i.a("TopicsFailed"),a.topics=new i.a("Topics"),a.topicsFailed=new i.a("TopicsFailed"),a.topicGroup=new i.a("TopicGroup"),a.topicGroupFailed=new i.a("TopicGroupFailed"),a.updateTopicFollowedState=new i.a("UpdateTopicFollowedState"),a.updateTopicFollowedStateFailed=new i.a("UpdateTopicFollowedStateFailed")},YS0M:function(t,e,o){"use strict";o.r(e),o.d(e,"TelemetryDataConnector",(function(){return u})),o.d(e,"TelemetryDataReducer",(function(){return p})),o.d(e,"ToolingInfo",(function(){return h}));var i=o("1w6q"),a=o("9J8d"),n=o("u5KZ"),s=o("w0HK"),c=o("loKy"),r=o("s9+9");const d="tp";var l=o("C4R5");class u extends i.a{constructor(t,e,o,i,d,u,p){super(t,e,o,i,d,u,p);const h=Object(s.a)(),m=h.getSelectedPivot();if(m&&m.telemetryPivotCategory){let t;t.page.pivot=m.telemetryPivotCategory,n.a.updatePageMetadata(t)}const y=a.a.getInstance().rootReducer.connector(r.a.SharedState);y&&y.getCurrentState().useHistory?Object(l.d)().addSwitchListener(this.onPivotSwitch,c.a.Telemetry):h.addSwitchListener(this.onPivotSwitch,c.a.Telemetry)}onPivotSwitch(t){let e;const o=t.newSelection;if(o&&(n.a.addOrUpdateCustomProperty(d,o.display),e={feed:{id:o.pivotId,name:o.display,type:"xfeed"===o.telemetryPageName?"category filter":void 0},page:{content:{topic:o.display},pivot:""}},o.telemetryPivotCategory&&(e.page.pivot=o.telemetryPivotCategory),n.a.updatePageMetadata(e)),t.oldSelection)return o.telemetryPageName&&(e.page.name=o.telemetryPageName),n.a.updatePageMetadata(e),void n.a.sendPageView(null,!1)}}class p{reduce(t,e){return{}}}const h={experienceConfigSchema:{}}}}]);